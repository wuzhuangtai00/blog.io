---
layout: post
title: '最近写的若干道莫比乌斯反演'
date: 2016-1-14 12:15
comments: true
categories: 

---

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>
莫比乌斯反演:

$$F(n)=\sum_{d|n}f(d) \Rightarrow f(n)=\sum_{d|n}F(d) \mu(\frac{n}{d})$$

实质上就是容斥

还有一种形式是

$$F(n)=\sum_{n|d}f(d) \Rightarrow f(n)=\sum_{n|d}F(n) \mu(\frac{d}{n})$$


---


一种简单的问题形式

$$\sum_{i=1}^{n} \sum_{j=1}^{m}f(gcd(i,j))\\
=\sum_{d=1}^{n} f(d) \sum_{i=1}^{\lfloor \frac{n}{d} \rfloor} \sum_{j=1}^{\lfloor \frac{m}{d} \rfloor}[gcd(i,j)==1]\\
=\sum_{d=1}^{n} f(d) \sum_{i=1}^{\lfloor \frac{n}{d} \rfloor} \sum_{j=1}^{\lfloor \frac{m}{d} \rfloor} \sum_{d'|gcd(i,j)}\mu(d')\\
=\sum_{d=1}^{n} f(d) \sum_{d'=1}^{\lfloor \frac{n}{d} \rfloor} \mu(d') \lfloor \frac{n}{dd'} \rfloor\lfloor \frac{m}{dd'} \rfloor\\
$$

令

$$g(n)=\sum_{d|n}f(d)\mu(d')$$

继续化简原式

$$原式=\sum_{i=1}^{n}g(n)\lfloor \frac{n}{i}\rfloor \lfloor \frac{m}{i}\rfloor$$

只要预处理出$$g$$数组的前缀和就能$$O(\sqrt(n)+\sqrt(m))$$回答询问

如果$$f$$数组没有特殊性质,则把每个数对它的所有倍数计算贡献，复杂度$$O(nlogn)$$

否则如果能通过预处理达成，复杂度$$O(n)$$

---

bzoj 3529

题意:令$$F(i)$$为$$i$$的约数和，$$q$$次给定$$n$$,$$m$$,$$a$$,求

$$\sum_{i=1}^{n} \sum_{j=1}^{m} F(gcd(i,j)) \times [F(gcd(i,j))\leq a]$$

先不考虑限制进行推导

$$\sum_{i=1}^{n} \sum_{j=1}^{m} F(gcd(i,j)\\
=\sum_{P=1}^{n}F(P) \sum_{i=1}^{\lfloor \frac{n}{P} \rfloor}\sum_{j=1}^{\lfloor \frac{m}{P} \rfloor} [gcd(i,j)==1]\\
=\sum_{P=1}^{n}F(P) \sum_{i=1}^{\lfloor \frac{n}{P} \rfloor}\sum_{j=1}^{\lfloor \frac{m}{P} \rfloor} \sum_{d|gcd(i,j)}\mu(d)\\
=\sum_{P=1}^{n}F(P) \sum_{d=1}^{\lfloor \frac{n}{P} \rfloor}\mu(d)\lfloor \frac{n}{Pd} \rfloor\lfloor \frac{m}{Pd} \rfloor \\
=\sum_{i=1}^{n}\lfloor \frac{n}{i} \rfloor\lfloor \frac{m}{i} \rfloor\sum_{d|i}\mu(d)F(\frac{i}{d})$$

再用上述方法预处理前缀和就好啦

如果有那个限制，就离线下来之后把$$F(i)$$从小到大加.

---

给定$$n,m$$,求

$$\sum_{i=1}^{n} \sum_{j=1}^{m}lcm(i,j)$$

推导:

$$\sum_{i=1}^{n} \sum_{j=1}^{m}lcm(i,j)\\
=\sum_{i=1}^{n} \sum_{j=1}^{m}\frac{ij}{gcd(i,j)}\\
=\sum_{d=1}^{n} d \sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum_{j=1}^{\lfloor\frac{m}{d}\rfloor}ij\times(gcd(i,j)==1)$$

令

$$F(n,m)=\sum_{i=1}^{n}\sum_{j=1}^{m}ij\times[gcd(i,j)==1]\\
=\sum_{i=1}^{n}\sum_{j=1}^{m} ij \times\sum_{d|gcd(i,j))}\mu(d)\\
=\sum_{d=1}^{n}\mu(d)d^2\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}i\sum_{j=1}^{\lfloor\frac{m}{d}\rfloor}j$$

则可得

$$原式=\sum_{d=1}^{n} d \sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum_{j=1}^{\lfloor\frac{m}{d}\rfloor}ij\times(gcd(i,j)==1)\\
=\sum_{d=1}^{n}d\times F(\lfloor\frac{n}{d}\rfloor,\lfloor\frac{m}{d}\rfloor)$$

$$F$$显然$$O(sqrt(n))$$可求.再对答案也$$\sqrt(n)$$分块，窝们可以得到$$O(n)$$单组询问的方法.

有没有更好的复杂度呢?窝们继续化简.

$$\sum_{d=1}^{n}d\times F(\lfloor\frac{n}{d}\rfloor,\lfloor\frac{m}{d}\rfloor)\\
=\sum_{d=1}^{n}d\times\sum_{d=1}^{\lfloor\frac{n}{d}\rfloor}\mu(d)d^2\sum_{i=1}^{\lfloor\frac{n}{id}\rfloor}i\sum_{j=1}^{\lfloor\frac{m}{id}\rfloor}j\\
=\sum_{i=1} Sum(\lfloor\frac{n}{i}\rfloor,\lfloor\frac{m}{i}\rfloor)\times\sum_{d|i}\mu(d)d^2\frac{n}{d}\\
=\sum_{i=1} Sum(\lfloor\frac{n}{i}\rfloor,\lfloor\frac{m}{i}\rfloor)\times\sum_{d|i}\mu(d)nd$$

后面的东西是能线性筛的...因为首先它是积性函数..如果遇到$$i%prime[j]==0$$新加进去的$$\mu$$都为0,只要把它乘上$$prime[j]$$即可

---

GCD_Array


  1. Add v to ax for every x that gcd(x,n)=d.
  2. Query $$\sum_{i=1}^{x} a_i$$
 
窝用了个很麻烦的办法来证明..问了下fsf..觉得比窝不知道高到哪里去了

考虑某次操作对位置$$x$$的贡献

$$v \times [gcd(x,n)==d]\\
=v \times [gcd (\frac{x}{d},\frac{n}{d})==1]\\
=v \times \sum_{i|\frac{x}{d},i|\frac{n}{d}}\mu(i)$$

然后把$$\frac{n}{d}$$交给修改,$$\frac{x}{d}$$交给询问.

即在修改时,把所有$$id$$使得$$i | \frac{n}{d} $$的数加上$$v\times \mu(i)$$

在询问时，即相当于询问$$\sum_{i=1}^{x} \lfloor \frac{x}{i}  \rfloor a_i$$

这个分块+维护前缀和即可.

感受到了智商的碾压.

---

求$$\sum_{i=1}^{n}f_i$$
